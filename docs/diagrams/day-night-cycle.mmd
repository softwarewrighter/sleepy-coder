flowchart LR
    subgraph Day["â˜€ï¸ DAY: Agent Attempts"]
        T[Load Task] --> S[Sandbox]
        S --> Check{cargo check}
        Check -->|Error| LLM[Call Ollama]
        LLM --> Fix[Apply Fix]
        Fix --> S
        Check -->|Pass| E[Create Episode]
    end

    subgraph Night["ðŸŒ™ NIGHT: Training"]
        Load[Load Failed Episodes] --> Curate[Curate Dataset]
        Curate --> Train[LoRA Fine-tune]
        Train --> Adapter[Save Adapter]
    end

    subgraph Eval["ðŸ“Š EVAL: Gating"]
        Frozen[Run Frozen Set] --> Metrics[Compute Metrics]
        Metrics --> Gate{Gates Pass?}
        Gate -->|Yes| Promote[Promote Adapter]
        Gate -->|No| Keep[Keep Previous]
    end

    E --> DB[(SQLite)]
    DB --> Load
    Adapter --> Frozen
    Promote --> Ollama[(Ollama)]
