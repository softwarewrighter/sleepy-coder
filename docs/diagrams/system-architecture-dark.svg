<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700" font-family="Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif">
  <defs>
    <!-- Gradients -->
    <linearGradient id="rustGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#C2410C"/>
      <stop offset="100%" style="stop-color:#EA580C"/>
    </linearGradient>
    <linearGradient id="pythonGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1D4ED8"/>
      <stop offset="100%" style="stop-color:#3B82F6"/>
    </linearGradient>
    <linearGradient id="dayGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#B8860B"/>
      <stop offset="100%" style="stop-color:#DAA520"/>
    </linearGradient>
    <linearGradient id="nightGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4C51BF"/>
      <stop offset="100%" style="stop-color:#6366F1"/>
    </linearGradient>
    <linearGradient id="evalGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#047857"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>

    <!-- Shadows and effects -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.4"/>
    </filter>

    <!-- Arrow markers -->
    <marker id="arrowWhite" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#FFFFFF"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#FB923C"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#60A5FA"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#6EE7B7"/>
    </marker>

    <!-- Grid pattern -->
    <pattern id="grid" patternUnits="userSpaceOnUse" width="40" height="40">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#2A2A4A" stroke-width="0.5"/>
    </pattern>
  </defs>

  <!-- Dark background -->
  <rect width="1000" height="700" fill="#1A1A2E"/>
  <rect width="1000" height="700" fill="url(#grid)" opacity="0.4"/>

  <!-- Title -->
  <text x="500" y="38" text-anchor="middle" font-size="24" font-weight="700" fill="#FFFFFF">Sleepy-Coder: Continual Learning for Rust Code Repair</text>
  <text x="500" y="62" text-anchor="middle" font-size="13" fill="#A0AEC0">Self-improving agent with day/night learning cycle</text>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- CENTRAL CYCLE -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <!-- Cycle ring -->
  <circle cx="500" cy="360" r="145" fill="none" stroke="#3D3D5C" stroke-width="25" opacity="0.6"/>

  <!-- DAY Phase -->
  <g filter="url(#shadow)">
    <rect x="420" y="210" width="160" height="60" rx="12" fill="url(#dayGrad)"/>
  </g>
  <circle cx="445" cy="240" r="12" fill="#FCD34D" filter="url(#glow)"/>
  <g stroke="#1A1A2E" stroke-width="2" stroke-linecap="round">
    <line x1="445" y1="225" x2="445" y2="220"/>
    <line x1="445" y1="260" x2="445" y2="255"/>
    <line x1="430" y1="240" x2="425" y2="240"/>
    <line x1="465" y1="240" x2="460" y2="240"/>
  </g>
  <text x="500" y="235" text-anchor="middle" font-size="14" font-weight="700" fill="#FFFFFF">DAY</text>
  <text x="500" y="255" text-anchor="middle" font-size="10" fill="#FEF3C7">Agent Attempts Fixes</text>

  <!-- NIGHT Phase -->
  <g filter="url(#shadow)">
    <rect x="280" y="400" width="140" height="60" rx="12" fill="url(#nightGrad)"/>
  </g>
  <circle cx="305" cy="430" r="10" fill="#A5B4FC" filter="url(#glow)"/>
  <circle cx="311" cy="425" r="7" fill="url(#nightGrad)"/>
  <text x="350" y="425" text-anchor="middle" font-size="14" font-weight="700" fill="#FFFFFF">NIGHT</text>
  <text x="350" y="445" text-anchor="middle" font-size="10" fill="#C7D2FE">LoRA Fine-tuning</text>

  <!-- EVAL Phase -->
  <g filter="url(#shadow)">
    <rect x="580" y="400" width="140" height="60" rx="12" fill="url(#evalGrad)"/>
  </g>
  <circle cx="605" cy="430" r="10" fill="#6EE7B7" filter="url(#glow)"/>
  <polyline points="599,430 603,434 612,425" stroke="#065F46" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  <text x="650" y="425" text-anchor="middle" font-size="14" font-weight="700" fill="#FFFFFF">EVAL</text>
  <text x="650" y="445" text-anchor="middle" font-size="10" fill="#A7F3D0">Gated Promotion</text>

  <!-- Cycle arrows -->
  <path d="M430,270 Q350,320 320,400" fill="none" stroke="#FFFFFF" stroke-width="3" marker-end="url(#arrowWhite)"/>
  <path d="M420,430 Q500,500 580,430" fill="none" stroke="#FFFFFF" stroke-width="3" marker-end="url(#arrowWhite)"/>
  <path d="M720,410 Q740,320 580,270" fill="none" stroke="#FFFFFF" stroke-width="3" marker-end="url(#arrowWhite)"/>

  <!-- Center label -->
  <circle cx="500" cy="360" r="50" fill="#292524" stroke="#525252" stroke-width="2"/>
  <text x="500" y="355" text-anchor="middle" font-size="13" font-weight="700" fill="#FFFFFF">Continual</text>
  <text x="500" y="372" text-anchor="middle" font-size="13" font-weight="700" fill="#FFFFFF">Learning</text>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- LEFT: RUST COMPONENTS -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <g filter="url(#shadow)">
    <rect x="40" y="95" width="190" height="30" rx="6" fill="url(#rustGrad)"/>
  </g>
  <text x="135" y="115" text-anchor="middle" font-size="13" font-weight="700" fill="#FFFFFF">Rust Runtime</text>

  <!-- Rust boxes - dark fill, colored border, white text -->
  <g>
    <rect x="40" y="135" width="88" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="84" y="157" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">CLI</text>
    <text x="84" y="173" text-anchor="middle" font-size="9" fill="#A0AEC0">Interface</text>

    <rect x="138" y="135" width="92" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="184" y="157" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Agent Loop</text>
    <text x="184" y="173" text-anchor="middle" font-size="9" fill="#A0AEC0">RED→FIX→GREEN</text>

    <rect x="40" y="195" width="88" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="84" y="217" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Sandbox</text>
    <text x="84" y="233" text-anchor="middle" font-size="9" fill="#A0AEC0">cargo check</text>

    <rect x="138" y="195" width="92" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="184" y="217" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Capture</text>
    <text x="184" y="233" text-anchor="middle" font-size="9" fill="#A0AEC0">Episodes</text>

    <rect x="40" y="255" width="88" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="84" y="277" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Koans</text>
    <text x="84" y="293" text-anchor="middle" font-size="9" fill="#A0AEC0">42 Tasks</text>

    <rect x="138" y="255" width="92" height="50" rx="8" fill="#292524" stroke="#FB923C" stroke-width="2"/>
    <text x="184" y="277" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Eval</text>
    <text x="184" y="293" text-anchor="middle" font-size="9" fill="#A0AEC0">Metrics</text>
  </g>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- RIGHT: PYTHON COMPONENTS -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <g filter="url(#shadow)">
    <rect x="770" y="95" width="190" height="30" rx="6" fill="url(#pythonGrad)"/>
  </g>
  <text x="865" y="115" text-anchor="middle" font-size="13" font-weight="700" fill="#FFFFFF">Python Training</text>

  <g>
    <rect x="770" y="135" width="88" height="50" rx="8" fill="#1E1B4B" stroke="#60A5FA" stroke-width="2"/>
    <text x="814" y="157" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">SFT Data</text>
    <text x="814" y="173" text-anchor="middle" font-size="9" fill="#A0AEC0">Curation</text>

    <rect x="868" y="135" width="92" height="50" rx="8" fill="#1E1B4B" stroke="#60A5FA" stroke-width="2"/>
    <text x="914" y="157" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">LoRA</text>
    <text x="914" y="173" text-anchor="middle" font-size="9" fill="#A0AEC0">Fine-tune</text>

    <rect x="770" y="195" width="88" height="50" rx="8" fill="#1E1B4B" stroke="#60A5FA" stroke-width="2"/>
    <text x="814" y="217" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Share</text>
    <text x="814" y="233" text-anchor="middle" font-size="9" fill="#A0AEC0">Consolidate</text>

    <rect x="868" y="195" width="92" height="50" rx="8" fill="#1E1B4B" stroke="#60A5FA" stroke-width="2"/>
    <text x="914" y="217" text-anchor="middle" font-size="11" font-weight="600" fill="#FFFFFF">Viz</text>
    <text x="914" y="233" text-anchor="middle" font-size="9" fill="#A0AEC0">Plots</text>
  </g>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- BOTTOM: DATA STORES -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <!-- SQLite -->
  <rect x="180" y="530" width="130" height="85" rx="10" fill="#292524" stroke="#FFFFFF" stroke-width="2"/>
  <ellipse cx="245" cy="550" rx="18" ry="6" fill="none" stroke="#A0AEC0" stroke-width="1.5"/>
  <path d="M227,550 v18 a18,6 0 0,0 36,0 v-18" fill="none" stroke="#A0AEC0" stroke-width="1.5"/>
  <text x="245" y="588" text-anchor="middle" font-size="12" font-weight="600" fill="#FFFFFF">SQLite</text>
  <text x="245" y="604" text-anchor="middle" font-size="9" fill="#A0AEC0">Episodes DB</text>

  <!-- Ollama -->
  <rect x="690" y="530" width="130" height="85" rx="10" fill="#292524" stroke="#FFFFFF" stroke-width="2"/>
  <circle cx="755" cy="560" r="16" fill="#404040" stroke="#A0AEC0" stroke-width="2"/>
  <path d="M744,555 Q752,548 755,555 Q758,548 766,555" fill="none" stroke="#A0AEC0" stroke-width="2"/>
  <path d="M744,565 Q752,572 755,565 Q758,572 766,565" fill="none" stroke="#A0AEC0" stroke-width="2"/>
  <text x="755" y="593" text-anchor="middle" font-size="12" font-weight="600" fill="#FFFFFF">Ollama</text>
  <text x="755" y="609" text-anchor="middle" font-size="9" fill="#A0AEC0">Local LLM</text>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- DATA FLOW ARROWS - Routed around edges to avoid crossing -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <!-- LEFT SIDE FLOWS -->

  <!-- Rust → Day: horizontal arrow from Rust area to Day box -->
  <path d="M230,160 L260,160 L260,240 L420,240" fill="none" stroke="#FB923C" stroke-width="2.5" marker-end="url(#arrowOrange)"/>
  <text x="280" y="152" font-size="9" font-weight="500" fill="#FB923C">tasks</text>

  <!-- Day → SQLite: down the left side -->
  <path d="M420,255 L270,255 L270,530" fill="none" stroke="#FCD34D" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowWhite)"/>
  <text x="255" y="400" font-size="9" font-weight="500" fill="#FCD34D" transform="rotate(-90, 255, 400)">episodes</text>

  <!-- SQLite → Night: short upward connection -->
  <path d="M280,530 L320,530 L320,460" fill="none" stroke="#A5B4FC" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowBlue)"/>
  <text x="335" y="500" font-size="9" font-weight="500" fill="#A5B4FC">train data</text>

  <!-- NIGHT → PYTHON FLOW -->

  <!-- Night → Python: go up to clear cycle, then across to Python left side -->
  <path d="M350,400 L350,190 L770,190" fill="none" stroke="#60A5FA" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowBlue)"/>
  <text x="550" y="182" font-size="9" font-weight="500" fill="#60A5FA">SFT training</text>

  <!-- RIGHT SIDE FLOWS -->

  <!-- Python → Eval: down the right side -->
  <path d="M865,245 L865,490 L720,430" fill="none" stroke="#6EE7B7" stroke-width="2.5" stroke-dasharray="6,4" marker-end="url(#arrowGreen)"/>
  <text x="878" y="370" font-size="9" font-weight="500" fill="#6EE7B7" transform="rotate(90, 878, 370)">adapter</text>

  <!-- Eval → Ollama: short downward connection -->
  <path d="M720,440 L755,440 L755,530" fill="none" stroke="#6EE7B7" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowWhite)"/>
  <text x="738" y="485" font-size="9" font-weight="500" fill="#A0AEC0">promote</text>

  <!-- BOTTOM FLOW -->

  <!-- Ollama → Rust (inference): along the bottom -->
  <path d="M690,572 L450,620 L135,620 L135,310" fill="none" stroke="#525252" stroke-width="1.5" stroke-dasharray="4,4" opacity="0.5"/>
  <text x="400" y="635" font-size="9" fill="#6B7280">inference requests</text>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- ANNOTATION BOXES -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <!-- Error families -->
  <rect x="40" y="330" width="180" height="80" rx="8" fill="#292524" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="55" y="352" font-size="10" font-weight="600" fill="#FCD34D">Error Families</text>
  <text x="55" y="370" font-size="9" fill="#A0AEC0">BorrowChecker | Lifetimes</text>
  <text x="55" y="385" font-size="9" fill="#A0AEC0">TraitBounds | ResultHandling</text>
  <text x="55" y="400" font-size="9" fill="#A0AEC0">TypeMismatch | Other</text>

  <!-- Gating criteria -->
  <rect x="770" y="270" width="190" height="80" rx="8" fill="#292524" stroke="#34D399" stroke-width="1.5"/>
  <text x="785" y="292" font-size="10" font-weight="600" fill="#6EE7B7">Gating Criteria</text>
  <text x="785" y="310" font-size="9" fill="#A0AEC0">pass_rate >= 0.85</text>
  <text x="785" y="325" font-size="9" fill="#A0AEC0">frozen_pass_rate: no regression</text>
  <text x="785" y="340" font-size="9" fill="#A0AEC0">repeat_error_rate: decreasing</text>

  <!-- Data mix -->
  <rect x="770" y="400" width="190" height="60" rx="8" fill="#292524" stroke="#60A5FA" stroke-width="1.5"/>
  <text x="785" y="422" font-size="10" font-weight="600" fill="#93C5FD">Training Data Mix</text>
  <text x="785" y="440" font-size="9" fill="#A0AEC0">44% replay | 42% success</text>
  <text x="785" y="455" font-size="9" fill="#A0AEC0">14% hard cases (oversampled)</text>

  <!-- ═══════════════════════════════════════════════════════════════ -->
  <!-- LEGEND -->
  <!-- ═══════════════════════════════════════════════════════════════ -->

  <g transform="translate(40, 630)">
    <text x="0" y="0" font-size="11" font-weight="600" fill="#FFFFFF">Legend</text>

    <rect x="0" y="12" width="16" height="12" rx="2" fill="url(#rustGrad)"/>
    <text x="22" y="22" font-size="9" fill="#A0AEC0">Rust (runtime)</text>

    <rect x="120" y="12" width="16" height="12" rx="2" fill="url(#pythonGrad)"/>
    <text x="142" y="22" font-size="9" fill="#A0AEC0">Python (training)</text>

    <line x1="250" y1="18" x2="285" y2="18" stroke="#A0AEC0" stroke-width="2" stroke-dasharray="6,4"/>
    <text x="292" y="22" font-size="9" fill="#A0AEC0">Data flow</text>

    <circle cx="378" cy="18" r="8" fill="none" stroke="#A0AEC0" stroke-width="1.5"/>
    <text x="392" y="22" font-size="9" fill="#A0AEC0">Learning cycle</text>
  </g>

</svg>
